"use strict";(self.webpackChunkimpact_zone_frontend=self.webpackChunkimpact_zone_frontend||[]).push([[895],{3895:(a,e,t)=>{t.r(e),t.d(e,{default:()=>C});var l=t(5043),s=t(2468),n=t(7374),i=t(5050),o=t(3549),d=t(1688),c=t(9456),r=t(6038),u=t(7994),v=t(7275),p=t(4454),m=t(8085),f=t(4096),y=t(2114),h=t(346),x=t(579);const C=()=>{var a,e,t,C;const j=(0,c.wA)(),{id:g}=(0,d.g)(),{allEmployees:P,employeePayType:A}=(0,c.d4)((a=>a.employees)),[D,w]=(0,l.useState)({event:"",classMeet:"",classLocation:"",startDate:"",endDate:"",schedule:[{days:[],startTime:""}],instructor:[{assistant:null,assistantPay:""}],staff:null,payType:"",totalCapacity:null,waitlistPeople:null,clientSignupClass:!1,onlineCapacity:null,clientPaylater:!1,clientClassFree:!1,isActive:!0});(0,l.useEffect)((()=>{j((0,v.Vs)()),j((0,p.kQ)()),j((0,f.Oc)())}),[j]);const{locationDropdown:T}=(0,c.d4)((a=>a.locations)),{allEventClassesDropDown:N}=(0,c.d4)((a=>a.event));let{allEventClasses:b}=(0,c.d4)((a=>a.event));b=null===(a=b)||void 0===a?void 0:a.find((a=>a._id===(null===D||void 0===D?void 0:D.event)));const E=(0,d.W6)();(0,l.useEffect)((()=>{null!==D&&void 0!==D&&D.event&&w((a=>{var e,t;return{...a,totalCapacity:null===(e=b)||void 0===e?void 0:e.defaultMaxAttendes,waitlistPeople:null===(t=b)||void 0===t?void 0:t.maximumWaitlist}}))}),[null===D||void 0===D?void 0:D.event,b]),(0,l.useEffect)((()=>{g&&j((0,y.h5)(g,(a=>{var e,t,l;if(null!==a&&void 0!==a&&a.staff&&j((0,f.Zh)(null===a||void 0===a?void 0:a.staff)),w({event:a.event,classMeet:a.classMeet,classLocation:a.classLocation,startDate:new Date(a.startDate),endDate:new Date(a.endDate),schedule:null===(e=a.schedule)||void 0===e?void 0:e.map((a=>({...a,startTime:(0,m.yQ)(a.startTime)}))),instructor:a.instructor,staff:a.staff?null===a||void 0===a?void 0:a.staff:null,payType:a.pay,totalCapacity:a.totalCapacity?a.totalCapacity:null===(t=b)||void 0===t?void 0:t.defaultMaxAttendes,waitlistPeople:a.waitlistPeople?a.waitlistPeople:null===(l=b)||void 0===l?void 0:l.maximumWaitlist,clientSignupClass:a.clientSignupClass,onlineCapacity:a.onlineCapacity,clientPaylater:a.clientPaylater,clientClassFree:a.clientClassFree,isActive:a.isActive}),a.instructor&&a.instructor.length>0)for(const s of a.instructor)S(s.assistant)})))}),[g,j,P,b]);const S=async a=>{const e=P.find((e=>e._id===a));if(e){var t;const l=e.employeeClassData.map((a=>({name:a.label,value:a.payType}))).filter(((a,e,t)=>e===t.findIndex((e=>e.value===a.value)))),s=null===e||void 0===e||null===(t=e.employeeClassData)||void 0===t?void 0:t.find((a=>a.isDefaultPay));w((e=>({...e,instructor:e.instructor.map((e=>e.assistant===a?{...e,assistantPayOptions:l,assistantPay:s?s.payType:e.assistantPay}:e))})))}},k=(0,c.d4)((a=>{var e;return null===a||void 0===a||null===(e=a.loader)||void 0===e?void 0:e.isLoading})),_=a=>{let{name:e,value:t}=a;const l=(0,r.A)(e,t,D);w((a=>({...a,[e]:t,formErrors:l})))};(0,l.useEffect)((()=>{null!==D&&void 0!==D&&D.event&&(j((0,p.gw)(null===D||void 0===D?void 0:D.event)),w((a=>({...a,staff:null,payType:"",instructor:[{assistant:null,assistantPay:""}]}))))}),[null===D||void 0===D?void 0:D.event]);const{allServicesEvents:B}=(0,c.d4)((a=>a.event)),O=B&&(null===B||void 0===B||null===(e=B.EventService)||void 0===e?void 0:e.map((a=>{var e;return null===(e=a.eventLevel)||void 0===e?void 0:e._id}))),R=P.filter((a=>a.employeeClassData.some((a=>null===O||void 0===O?void 0:O.includes(a.isClassLevel))))).map((a=>({name:a.firstName,value:a._id})));(0,l.useEffect)((()=>(null!==D&&void 0!==D&&D.staff&&j((0,f.Zh)(null===D||void 0===D?void 0:D.staff)),()=>{j({type:h.g.CHANGE_EMPLOYEES_PAY_TYPE,payload:[]})})),[null===D||void 0===D?void 0:D.staff,j]),(0,l.useEffect)((()=>{if(A){var a;let e=null===A||void 0===A||null===(a=A.employeeClassData)||void 0===a?void 0:a.find((a=>a.isDefaultPay));w((a=>({...a,payType:e?e.payType:null})))}}),[A,P]);const I=async a=>{let{name:e,value:t,customIndex:l,fieldName:s}=a;const n={...D};let i=n[s][l];i[e]=t,"assistant"===e&&(n[s][l]=i,w((()=>({...n}))),await j((0,f.Zh)(t)));const o=(0,r.A)(e,t,i);if(i.formErrors=o,n[s][l]=i,w((()=>({...n}))),"assistant"===e){const a=t,e=P.find((e=>e._id===a));if(e){var d;const a=e.employeeClassData.map((a=>({name:a.label,value:a.payType}))).filter(((a,e,t)=>e===t.findIndex((e=>e.value===a.value)))),t=null===e||void 0===e||null===(d=e.employeeClassData)||void 0===d?void 0:d.find((a=>a.isDefaultPay));w((e=>({...e,instructor:e.instructor.map(((e,s)=>s===l?{...e,assistantPayOptions:a,assistantPay:t?t.payType:null}:e))})))}}},L=a=>{var e;const t=null===(e=D.instructor.filter(((e,t)=>t!==a)))||void 0===e?void 0:e.flatMap((a=>a.assistant)),l=[D.staff,...t];return R.filter((a=>!l.includes(a.value)))},M=(a,e)=>{w((t=>({...t,[e]:t[e].filter(((e,t)=>t!==a))})))};return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(i.A,{backText:"Classes",children:[(0,x.jsxs)(o.a,{children:[(0,x.jsx)(s.BR,{name:"event",label:"Class Name",options:N,onChange:_,data:D}),(0,x.jsx)(s.o4,{name:"isActive",data:D,onChange:_,extraClassName:"text-right"})]}),(0,x.jsxs)(o.Ay,{title:"When and Where",col:"12",children:[(0,x.jsxs)(o.a,{children:[(0,x.jsx)(s.BR,{name:"classMeet",label:"How often does class meet?",options:n.e6,onChange:_,data:D,col:"6"}),(0,x.jsx)(s.BR,{name:"classLocation",options:T,onChange:_,data:D,col:"6"}),(0,x.jsx)(s.wN,{name:"startDate",onChange:_,data:D}),(0,x.jsx)(s.wN,{name:"endDate",onChange:_,data:D,disabled:!(null!==D&&void 0!==D&&D.startDate)})]}),(0,x.jsx)(o.a,{extraClass:"justify-content-end",children:(0,x.jsx)(u.Ay,{label:"Add New Schedule",className:"mx-2 ",onClick:()=>{const a={days:[],startTime:"",timeFormat:""};w((e=>({...e,schedule:[...e.schedule,a]})))},loading:k})}),null===D||void 0===D||null===(t=D.schedule)||void 0===t?void 0:t.map(((a,e)=>(0,x.jsx)("div",{children:(0,x.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,x.jsx)(s.wN,{name:"startTime",customIndex:e,onChange:I,data:a,fieldName:"schedule",timeOnly:!0,placeholder:"Select Time",hourFormat:"12"}),(0,x.jsx)(s.Rx,{name:"days",customIndex:e,onChange:I,data:a,options:n.dl,fieldName:"schedule",col:4}),e>0&&(0,x.jsx)("i",{className:"pi pi-minus-circle mt-4",onClick:()=>M(e,"schedule")})]})},e)))]}),(0,x.jsxs)(o.Ay,{title:"Instructor",col:"12",children:[(0,x.jsxs)(o.a,{children:[(0,x.jsx)(s.BR,{name:"staff",options:R,onChange:_,data:D}),(0,x.jsx)(s.BR,{name:"payType",options:(()=>{var a,e;let t=null===A||void 0===A||null===(a=A.employeeClassData)||void 0===a?void 0:a.map((a=>({name:a.label,value:a.payType})));const l=new Set(null===t||void 0===t?void 0:t.map((a=>JSON.stringify(a))));return null===(e=Array.from(l))||void 0===e?void 0:e.map((a=>JSON.parse(a)))})(),onChange:_,data:D})]}),(0,x.jsx)(o.a,{extraClass:"justify-content-end",children:(0,x.jsx)(u.Ay,{label:"Add Assistant",className:"mx-2",onClick:()=>{const a={assistant:"",assistantPay:""};w((e=>({...e,instructor:[...e.instructor,a]})))},loading:k})}),null===D||void 0===D||null===(C=D.instructor)||void 0===C?void 0:C.map(((a,e)=>(0,x.jsx)("div",{children:(0,x.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,x.jsx)(s.BR,{name:"assistant",customIndex:e,options:L(e),fieldName:"instructor",onChange:I,data:a}),(0,x.jsx)(s.BR,{name:"assistantPay",customIndex:e,options:a.assistantPayOptions,fieldName:"instructor",onChange:I,data:a}),e>0&&(0,x.jsx)("i",{className:"pi pi-minus-circle mt-4",onClick:()=>M(e,"instructor")})]})},e)))]}),(0,x.jsx)(o.Ay,{title:"Participants",col:"12",children:(0,x.jsxs)(o.a,{children:[(0,x.jsx)(s.Bt,{name:"totalCapacity",onChange:_,data:D}),(0,x.jsx)(s.Bt,{name:"waitlistPeople",label:"How many people can waitlist",onChange:_,data:D})]})}),(0,x.jsx)(o.Ay,{title:"Online Scheduling",col:"12",children:(0,x.jsxs)(o.a,{children:[(0,x.jsx)(s.ZD,{name:"clientSignupClass",label:"Allow clients to sign up for this class online",onChange:_,data:D,col:"12"}),(0,x.jsx)(s.Bt,{name:"onlineCapacity",label:"Online Capacity",onChange:_,data:D,col:"6"})]})}),(0,x.jsx)(o.Ay,{title:"Pricing",col:"12",children:(0,x.jsxs)(o.a,{children:[(0,x.jsx)(s.ZD,{name:"clientPaylater",label:"Allow clients to sign up now and pay later",onChange:_,data:D,col:"12"}),(0,x.jsx)(s.ZD,{name:"clientClassFree",label:"Clients can attend this class for free",onChange:_,data:D,col:"12"})]})}),(0,x.jsxs)(u.zp,{children:[(0,x.jsx)(u.Ay,{label:"Save",className:"mx-2",onClick:()=>{if((0,m.nV)(D,w)){let a=(0,m.Kk)(D.schedule);a.isValid||w((e=>({...e,schedule:a.data}))),a.isValid&&j(g?(0,y.fA)(g,D,E):(0,y.gR)(D,E))}},loading:k}),(0,x.jsx)(u.Ti,{label:"Cancel",onClick:()=>E.goBack()})]})]})})}}}]);
//# sourceMappingURL=895.741d2f89.chunk.js.map