"use strict";(self.webpackChunkimpact_zone_frontend=self.webpackChunkimpact_zone_frontend||[]).push([[895],{3895:(a,e,s)=>{s.r(e),s.d(e,{default:()=>x});var t=s(5043),l=s(1326),n=s(7374),i=s(5050),o=s(5378),c=s(1688),d=s(9456),r=s(6038),u=s(7994),p=s(7275),v=s(4454),m=s(1830),y=s(1715),f=s(2114),h=s(346),C=s(579);const x=()=>{var a,e,s;const x=(0,d.wA)(),{id:j}=(0,c.g)(),{allEmployees:g,employeePayType:P}=(0,d.d4)((a=>a.employees)),[D,w]=(0,t.useState)({event:"",classMeet:"",classLocation:"",startDate:"",endDate:"",schedule:[{days:[],startTime:""}],instructor:[{assistant:null,assistantPay:""}],staff:"",payType:"",totalCapacity:null,waitlistPeople:null,clientSignupClass:!1,onlineCapacity:null,clientPaylater:!1,clientClassFree:!1});(0,t.useEffect)((()=>{x((0,p.Vs)()),x((0,v.kQ)()),x((0,y.Oc)())}),[x]),(0,t.useEffect)((()=>{j&&x((0,f.h5)(j,(a=>{var e;if(x((0,y.Zh)(null===a||void 0===a?void 0:a.staff)),w({event:a.event,classMeet:a.classMeet,classLocation:a.classLocation,startDate:new Date(a.startDate),endDate:new Date(a.endDate),schedule:null===(e=a.schedule)||void 0===e?void 0:e.map((a=>({...a,startTime:(0,m.yQ)(a.startTime)}))),instructor:a.instructor,staff:a.staff,payType:a.pay,totalCapacity:a.totalCapacity,waitlistPeople:a.waitlistPeople,clientSignupClass:a.clientSignupClass,onlineCapacity:a.onlineCapacity,clientPaylater:a.clientPaylater,clientClassFree:a.clientClassFree}),a.instructor&&a.instructor.length>0)for(const s of a.instructor)A(s.assistant)})))}),[j,x,g]);const A=async a=>{const e=g.find((e=>e._id===a));if(e){var s;const t=e.employeeClassData.map((a=>({name:a.label,value:a.payType}))).filter(((a,e,s)=>e===s.findIndex((e=>e.value===a.value)))),l=null===e||void 0===e||null===(s=e.employeeClassData)||void 0===s?void 0:s.find((a=>a.isDefaultPay));w((e=>({...e,instructor:e.instructor.map((e=>e.assistant===a?{...e,assistantPayOptions:t,assistantPay:l?l.payType:e.assistantPay}:e))})))}},{locationDropdown:T}=(0,d.d4)((a=>a.locations)),{allEventClassesDropDown:N}=(0,d.d4)((a=>a.event)),b=(0,c.W6)(),E=(0,d.d4)((a=>{var e;return null===a||void 0===a||null===(e=a.loader)||void 0===e?void 0:e.isLoading})),S=a=>{let{name:e,value:s}=a;const t=(0,r.A)(e,s,D);w((a=>({...a,[e]:s,formErrors:t})))};(0,t.useEffect)((()=>{null!==D&&void 0!==D&&D.event&&(x((0,v.gw)(null===D||void 0===D?void 0:D.event)),w((a=>({...a,staff:"",payType:"",instructor:[{assistant:null,assistantPay:""}]}))))}),[null===D||void 0===D?void 0:D.event]);const{allServicesEvents:k}=(0,d.d4)((a=>a.event)),B=k&&(null===k||void 0===k||null===(a=k.EventService)||void 0===a?void 0:a.map((a=>{var e;return null===(e=a.eventLevel)||void 0===e?void 0:e._id}))),_=g.filter((a=>a.employeeClassData.some((a=>null===B||void 0===B?void 0:B.includes(a.isClassLevel))))).map((a=>({name:a.firstName,value:a._id})));(0,t.useEffect)((()=>(null!==D&&void 0!==D&&D.staff&&x((0,y.Zh)(null===D||void 0===D?void 0:D.staff)),()=>{x({type:h.g.CHANGE_EMPLOYEES_PAY_TYPE,payload:[]})})),[null===D||void 0===D?void 0:D.staff,x]),(0,t.useEffect)((()=>{if(P){var a;let e=null===P||void 0===P||null===(a=P.employeeClassData)||void 0===a?void 0:a.find((a=>a.isDefaultPay));w((a=>({...a,payType:e?e.payType:null})))}}),[P,g]);const O=async a=>{let{name:e,value:s,customIndex:t,fieldName:l}=a;const n={...D};let i=n[l][t];i[e]=s,"assistant"===e&&(n[l][t]=i,w((()=>({...n}))),await x((0,y.Zh)(s)));const o=(0,r.A)(e,s,i);if(i.formErrors=o,n[l][t]=i,w((()=>({...n}))),"assistant"===e){const a=s,e=g.find((e=>e._id===a));if(e){var c;const a=e.employeeClassData.map((a=>({name:a.label,value:a.payType}))).filter(((a,e,s)=>e===s.findIndex((e=>e.value===a.value)))),s=null===e||void 0===e||null===(c=e.employeeClassData)||void 0===c?void 0:c.find((a=>a.isDefaultPay));w((e=>({...e,instructor:e.instructor.map(((e,l)=>l===t?{...e,assistantPayOptions:a,assistantPay:s?s.payType:null}:e))})))}}},R=a=>{var e;const s=null===(e=D.schedule)||void 0===e?void 0:e.flatMap(((e,s)=>s!==a?e.days:[]));return n.dl.filter((a=>!s.includes(a.value)))},I=a=>{var e;const s=null===(e=D.instructor.filter(((e,s)=>s!==a)))||void 0===e?void 0:e.flatMap((a=>a.assistant)),t=[D.staff,...s];return _.filter((a=>!t.includes(a.value)))},L=(a,e)=>{w((s=>({...s,[e]:s[e].filter(((e,s)=>s!==a))})))};return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(i.A,{backText:"Classes",children:[(0,C.jsx)(o.a,{children:(0,C.jsx)(l.BR,{name:"event",label:"Class Name",options:N,onChange:S,data:D})}),(0,C.jsxs)(o.Ay,{title:"When and Where",col:"12",children:[(0,C.jsxs)(o.a,{children:[(0,C.jsx)(l.BR,{name:"classMeet",label:"How often does class meet?",options:n.e6,onChange:S,data:D,col:"6"}),(0,C.jsx)(l.BR,{name:"classLocation",options:T,onChange:S,data:D,col:"6"}),(0,C.jsx)(l.wN,{name:"startDate",onChange:S,data:D}),(0,C.jsx)(l.wN,{name:"endDate",onChange:S,data:D})]}),(0,C.jsx)(o.a,{extraClass:"justify-content-end",children:(0,C.jsx)(u.Ay,{label:"Add New Schedule",className:"mx-2 ",onClick:()=>{const a={days:[],startTime:""};w((e=>({...e,schedule:[...e.schedule,a]})))},loading:E})}),null===D||void 0===D||null===(e=D.schedule)||void 0===e?void 0:e.map(((a,e)=>(0,C.jsx)("div",{children:(0,C.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,C.jsx)(l.wN,{name:"startTime",customIndex:e,onChange:O,data:a,fieldName:"schedule",timeOnly:!0,placeholder:"Select Time"}),(0,C.jsx)(l.Rx,{name:"days",customIndex:e,options:R(e),onChange:O,data:a,fieldName:"schedule",col:4}),e>0&&(0,C.jsx)("i",{class:"pi pi-minus-circle mt-4",onClick:()=>L(e,"schedule")})]})},e)))]}),(0,C.jsxs)(o.Ay,{title:"Instructor",col:"12",children:[(0,C.jsxs)(o.a,{children:[(0,C.jsx)(l.BR,{name:"staff",options:_,onChange:S,data:D}),(0,C.jsx)(l.BR,{name:"payType",options:(()=>{var a,e;let s=null===P||void 0===P||null===(a=P.employeeClassData)||void 0===a?void 0:a.map((a=>({name:a.label,value:a.payType})));const t=new Set(null===s||void 0===s?void 0:s.map((a=>JSON.stringify(a))));return null===(e=Array.from(t))||void 0===e?void 0:e.map((a=>JSON.parse(a)))})(),onChange:S,data:D})]}),(0,C.jsx)(o.a,{extraClass:"justify-content-end",children:(0,C.jsx)(u.Ay,{label:"Add Assistant",className:"mx-2",onClick:()=>{const a={assistant:"",assistantPay:""};w((e=>({...e,instructor:[...e.instructor,a]})))},loading:E})}),null===D||void 0===D||null===(s=D.instructor)||void 0===s?void 0:s.map(((a,e)=>(0,C.jsx)("div",{children:(0,C.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,C.jsx)(l.BR,{name:"assistant",customIndex:e,options:I(e),fieldName:"instructor",onChange:O,data:a}),(0,C.jsx)(l.BR,{name:"assistantPay",customIndex:e,options:a.assistantPayOptions,fieldName:"instructor",onChange:O,data:a}),e>0&&(0,C.jsx)("i",{className:"pi pi-minus-circle mt-4",onClick:()=>L(e,"instructor")})]})},e)))]}),(0,C.jsx)(o.Ay,{title:"Participants",col:"12",children:(0,C.jsxs)(o.a,{children:[(0,C.jsx)(l.Bt,{name:"totalCapacity",onChange:S,data:D}),(0,C.jsx)(l.Bt,{name:"waitlistPeople",label:"How many people can waitlist",onChange:S,data:D})]})}),(0,C.jsx)(o.Ay,{title:"Online Scheduling",col:"12",children:(0,C.jsxs)(o.a,{children:[(0,C.jsx)(l.ZD,{name:"clientSignupClass",label:"Allow clients to sign up for this class online",onChange:S,data:D,col:"12"}),(0,C.jsx)(l.Bt,{name:"onlineCapacity",label:"Online Capacity",onChange:S,data:D,col:"6"})]})}),(0,C.jsx)(o.Ay,{title:"Pricing",col:"12",children:(0,C.jsxs)(o.a,{children:[(0,C.jsx)(l.ZD,{name:"clientPaylater",label:"Allow clients to sign up now and pay later",onChange:S,data:D,col:"12"}),(0,C.jsx)(l.ZD,{name:"clientClassFree",label:"Clients can attend this class for free",onChange:S,data:D,col:"12"})]})}),(0,C.jsxs)(u.zp,{children:[(0,C.jsx)(u.Ay,{label:"Save",className:"mx-2",onClick:()=>{if((0,m.nV)(D,w)){let a=(0,m.Kk)(D.schedule);a.isValid||w((e=>({...e,schedule:a.data}))),a.isValid&&x(j?(0,f.fA)(j,D,b):(0,f.gR)(D,b))}},loading:E}),(0,C.jsx)(u.Ti,{label:"Cancel",onClick:()=>b.goBack()})]})]})})}}}]);
//# sourceMappingURL=895.18d93222.chunk.js.map