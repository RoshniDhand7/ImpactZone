"use strict";(self.webpackChunkimpact_zone_frontend=self.webpackChunkimpact_zone_frontend||[]).push([[895],{3895:(e,a,l)=>{l.r(a),l.d(a,{default:()=>x});var s=l(5043),t=l(8945),n=l(8740),i=l(5050),o=l(5378),c=l(1688),d=l(9456),r=l(6038),u=l(7994),p=l(7275),v=l(4454),m=l(1830),y=l(1715),f=l(2114),h=l(346),C=l(579);const x=()=>{var e,a,l;const x=(0,d.wA)(),{id:g}=(0,c.g)(),{allEmployees:j,employeePayType:P}=(0,d.d4)((e=>e.employees)),[D,w]=(0,s.useState)({event:"",classMeet:"",classLocation:"",startDate:"",endDate:"",schedule:[{days:[],startTime:""}],instructor:[{assistant:null,assistantPay:""}],staff:"",payType:"",totalCapacity:null,waitlistPeople:null,clientSignupClass:!1,onlineCapacity:null,clientPaylater:!1,clientClassFree:!1});(0,s.useEffect)((()=>{x((0,p.Vs)()),x((0,v.kQ)()),x((0,y.Oc)())}),[]),(0,s.useEffect)((()=>{g&&x((0,f.h5)(g,(e=>{var a;if(x((0,y.Zh)(null===e||void 0===e?void 0:e.staff)),w({event:e.event,classMeet:e.classMeet,classLocation:e.classLocation,startDate:new Date(e.startDate),endDate:new Date(e.endDate),schedule:null===(a=e.schedule)||void 0===a?void 0:a.map((e=>({...e,startTime:(0,m.yQ)(e.startTime)}))),instructor:e.instructor,staff:e.staff,payType:e.pay,totalCapacity:e.totalCapacity,waitlistPeople:e.waitlistPeople,clientSignupClass:e.clientSignupClass,onlineCapacity:e.onlineCapacity,clientPaylater:e.clientPaylater,clientClassFree:e.clientClassFree}),e.instructor&&e.instructor.length>0)for(const l of e.instructor)A(l.assistant)})))}),[g,x,j]);const A=async e=>{const a=j.find((a=>a._id===e));if(a){var l;const s=a.employeeClassData.map((e=>({name:e.label,value:e.payType}))).filter(((e,a,l)=>a===l.findIndex((a=>a.value===e.value)))),t=null===a||void 0===a||null===(l=a.employeeClassData)||void 0===l?void 0:l.find((e=>e.isDefaultPay));w((a=>({...a,instructor:a.instructor.map((a=>a.assistant===e?{...a,assistantPayOptions:s,assistantPay:t?t.payType:a.assistantPay}:a))})))}},{locationDropdown:T}=(0,d.d4)((e=>e.locations)),{allEventClassesDropDown:N}=(0,d.d4)((e=>e.event)),b=(0,c.W6)(),E=(0,d.d4)((e=>{var a;return null===e||void 0===e||null===(a=e.loader)||void 0===a?void 0:a.isLoading})),S=e=>{let{name:a,value:l}=e;const s=(0,r.A)(a,l,D);w((e=>({...e,[a]:l,formErrors:s})))};(0,s.useEffect)((()=>{null!==D&&void 0!==D&&D.event&&x((0,v.gw)(null===D||void 0===D?void 0:D.event))}),[null===D||void 0===D?void 0:D.event]);const{allServicesEvents:k}=(0,d.d4)((e=>e.event)),B=k&&(null===k||void 0===k||null===(e=k.EventService)||void 0===e?void 0:e.map((e=>{var a;return null===(a=e.eventLevel)||void 0===a?void 0:a._id}))),_=j.filter((e=>e.employeeClassData.some((e=>null===B||void 0===B?void 0:B.includes(e.isClassLevel))))).map((e=>({name:e.firstName,value:e._id})));(0,s.useEffect)((()=>(null!==D&&void 0!==D&&D.staff&&x((0,y.Zh)(null===D||void 0===D?void 0:D.staff)),()=>{x({type:h.g.CHANGE_EMPLOYEES_PAY_TYPE,payload:[]})})),[null===D||void 0===D?void 0:D.staff,x]),(0,s.useEffect)((()=>{if(P){var e;let a=null===P||void 0===P||null===(e=P.employeeClassData)||void 0===e?void 0:e.find((e=>e.isDefaultPay));console.log(a,P,"defaultPaySingle"),w((e=>({...e,payType:a?a.payType:null})))}}),[P,j]);const O=async e=>{let{name:a,value:l,customIndex:s,fieldName:t}=e;const n={...D};let i=n[t][s];i[a]=l,"assistant"===a&&(n[t][s]=i,w((()=>({...n}))),await x((0,y.Zh)(l)));const o=(0,r.A)(a,l,i);if(i.formErrors=o,n[t][s]=i,w((()=>({...n}))),"assistant"===a){const e=l,a=j.find((a=>a._id===e));if(console.log(a,"employeeWithLevel"),a){var c;const e=a.employeeClassData.map((e=>({name:e.label,value:e.payType}))).filter(((e,a,l)=>a===l.findIndex((a=>a.value===e.value)))),l=null===a||void 0===a||null===(c=a.employeeClassData)||void 0===c?void 0:c.find((e=>e.isDefaultPay));console.log("defaultPayMul>>",e,l,P),w((a=>({...a,instructor:a.instructor.map(((a,t)=>t===s?{...a,assistantPayOptions:e,assistantPay:l?l.payType:null}:a))})))}}};console.log(D,"data");const R=e=>{var a;const l=null===(a=D.schedule)||void 0===a?void 0:a.flatMap(((a,l)=>l!==e?a.days:[]));return n.dl.filter((e=>!l.includes(e.value)))},L=e=>{var a;const l=null===(a=D.instructor.filter(((a,l)=>l!==e)))||void 0===a?void 0:a.flatMap((e=>e.assistant)),s=[D.staff,...l];return _.filter((e=>!s.includes(e.value)))},I=(e,a)=>{w((l=>({...l,[a]:l[a].filter(((a,l)=>l!==e))})))};return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(i.A,{backText:"Classes",children:[(0,C.jsx)(o.a,{children:(0,C.jsx)(t.BR,{name:"event",label:"Class Name",options:N,onChange:S,data:D})}),(0,C.jsxs)(o.Ay,{title:"When and Where",col:"12",children:[(0,C.jsxs)(o.a,{children:[(0,C.jsx)(t.BR,{name:"classMeet",label:"How often does class meet?",options:n.e6,onChange:S,data:D,col:"6"}),(0,C.jsx)(t.BR,{name:"classLocation",options:T,onChange:S,data:D,col:"6"}),(0,C.jsx)(t.wN,{name:"startDate",onChange:S,data:D}),(0,C.jsx)(t.wN,{name:"endDate",onChange:S,data:D})]}),(0,C.jsx)(o.a,{extraClass:"justify-content-end",children:(0,C.jsx)(u.Ay,{label:"Add New Schedule",className:"mx-2 ",onClick:()=>{const e={days:[],startTime:""};w((a=>({...a,schedule:[...a.schedule,e]})))},loading:E})}),null===D||void 0===D||null===(a=D.schedule)||void 0===a?void 0:a.map(((e,a)=>(0,C.jsx)("div",{children:(0,C.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,C.jsx)(t.wN,{name:"startTime",customIndex:a,onChange:O,data:e,fieldName:"schedule",timeOnly:!0,placeholder:"Select Time"}),(0,C.jsx)(t.Rx,{name:"days",customIndex:a,options:R(a),onChange:O,data:e,fieldName:"schedule",col:4}),a>0&&(0,C.jsx)("i",{class:"pi pi-minus-circle mt-4",onClick:()=>I(a,"schedule")})]})},a)))]}),(0,C.jsxs)(o.Ay,{title:"Instructor",col:"12",children:[(0,C.jsxs)(o.a,{children:[(0,C.jsx)(t.BR,{name:"staff",options:_,onChange:S,data:D}),(0,C.jsx)(t.BR,{name:"payType",options:(()=>{var e,a;let l=null===P||void 0===P||null===(e=P.employeeClassData)||void 0===e?void 0:e.map((e=>({name:e.label,value:e.payType})));const s=new Set(null===l||void 0===l?void 0:l.map((e=>JSON.stringify(e))));return null===(a=Array.from(s))||void 0===a?void 0:a.map((e=>JSON.parse(e)))})(),onChange:S,data:D})]}),(0,C.jsx)(o.a,{extraClass:"justify-content-end",children:(0,C.jsx)(u.Ay,{label:"Add Assistant",className:"mx-2",onClick:()=>{const e={assistant:"",assistantPay:""};w((a=>({...a,instructor:[...a.instructor,e]})))},loading:E})}),null===D||void 0===D||null===(l=D.instructor)||void 0===l?void 0:l.map(((e,a)=>(0,C.jsx)("div",{children:(0,C.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,C.jsx)(t.BR,{name:"assistant",customIndex:a,options:L(a),fieldName:"instructor",onChange:O,data:e}),(0,C.jsx)(t.BR,{name:"assistantPay",customIndex:a,options:e.assistantPayOptions,fieldName:"instructor",onChange:O,data:e}),a>0&&(0,C.jsx)("i",{className:"pi pi-minus-circle mt-4",onClick:()=>I(a,"instructor")})]})},a)))]}),(0,C.jsx)(o.Ay,{title:"Participants",col:"12",children:(0,C.jsxs)(o.a,{children:[(0,C.jsx)(t.Bt,{name:"totalCapacity",onChange:S,data:D}),(0,C.jsx)(t.Bt,{name:"waitlistPeople",label:"How many people can waitlist",onChange:S,data:D})]})}),(0,C.jsx)(o.Ay,{title:"Online Scheduling",col:"12",children:(0,C.jsxs)(o.a,{children:[(0,C.jsx)(t.ZD,{name:"clientSignupClass",label:"Allow clients to sign up for this class online",onChange:S,data:D,col:"12"}),(0,C.jsx)(t.Bt,{name:"onlineCapacity",label:"Online Capacity",onChange:S,data:D,col:"6"})]})}),(0,C.jsx)(o.Ay,{title:"Pricing",col:"12",children:(0,C.jsxs)(o.a,{children:[(0,C.jsx)(t.ZD,{name:"clientPaylater",label:"Allow clients to sign up now and pay later",onChange:S,data:D,col:"12"}),(0,C.jsx)(t.ZD,{name:"clientClassFree",label:"Clients can attend this class for free",onChange:S,data:D,col:"12"})]})}),(0,C.jsxs)(u.zp,{children:[(0,C.jsx)(u.Ay,{label:"Save",className:"mx-2",onClick:()=>{if((0,m.nV)(D,w)){let e=(0,m.Kk)(D.schedule);e.isValid||(w((a=>({...a,schedule:e.data}))),x((0,f.gR)(D,b))),x(g?(0,f.fA)(g,D,b):(0,f.gR)(D,b))}},loading:E}),(0,C.jsx)(u.Ti,{label:"Cancel",onClick:()=>b.goBack()})]})]})})}}}]);
//# sourceMappingURL=895.f7a8f94b.chunk.js.map