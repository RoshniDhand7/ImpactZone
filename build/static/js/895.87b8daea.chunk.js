"use strict";(self.webpackChunkimpact_zone_frontend=self.webpackChunkimpact_zone_frontend||[]).push([[895],{3895:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var s=t(5043),l=t(666),n=t(7374),i=t(5050),o=t(3549),d=t(1688),c=t(9456),r=t(6038),u=t(7994),v=t(9106),p=t(3335),m=t(346),f=t(639),y=t(1878),h=t(5711),x=t(579);const C=()=>{var e,a,t,C;const g=(0,c.wA)(),{id:j}=(0,d.g)(),{employees:P,employeePayType:A}=(0,c.d4)((e=>e.settings.employee)),[D,w]=(0,s.useState)({event:"",classMeet:"",classLocation:"",startDate:"",endDate:"",schedule:[{days:[],startTime:""}],instructor:[{assistant:null,assistantPay:""}],staff:null,payType:"",totalCapacity:null,waitlistPeople:null,clientSignupClass:!1,onlineCapacity:null,clientPaylater:!1,clientClassFree:!1,isActive:!0});(0,s.useEffect)((()=>{g((0,f.Vs)()),g((0,v.kQ)()),g((0,h.Oc)())}),[g]);const{locationDropdown:T}=(0,c.d4)((e=>e.settings.schedule)),{eventClassesDropDown:N}=(0,c.d4)((e=>e.settings.schedule));let{eventClasses:b}=(0,c.d4)((e=>e.settings.schedule));b=null===(e=b)||void 0===e?void 0:e.find((e=>e._id===(null===D||void 0===D?void 0:D.event)));const E=(0,d.W6)();(0,s.useEffect)((()=>{null!==D&&void 0!==D&&D.event&&w((e=>{var a,t;return{...e,totalCapacity:null===(a=b)||void 0===a?void 0:a.defaultMaxAttendes,waitlistPeople:null===(t=b)||void 0===t?void 0:t.maximumWaitlist}}))}),[null===D||void 0===D?void 0:D.event,b]),(0,s.useEffect)((()=>{j&&g((0,y.h5)(j,(e=>{var a,t,s;if(null!==e&&void 0!==e&&e.staff&&g((0,h.Zh)(null===e||void 0===e?void 0:e.staff)),w({event:e.event,classMeet:e.classMeet,classLocation:e.classLocation,startDate:new Date(e.startDate),endDate:new Date(e.endDate),schedule:null===(a=e.schedule)||void 0===a?void 0:a.map((e=>({...e,startTime:(0,p.yQ)(e.startTime)}))),instructor:e.instructor,staff:e.staff?null===e||void 0===e?void 0:e.staff:null,payType:e.pay,totalCapacity:e.totalCapacity?e.totalCapacity:null===(t=b)||void 0===t?void 0:t.defaultMaxAttendes,waitlistPeople:e.waitlistPeople?e.waitlistPeople:null===(s=b)||void 0===s?void 0:s.maximumWaitlist,clientSignupClass:e.clientSignupClass,onlineCapacity:e.onlineCapacity,clientPaylater:e.clientPaylater,clientClassFree:e.clientClassFree,isActive:e.isActive}),e.instructor&&e.instructor.length>0)for(const l of e.instructor)k(l.assistant)})))}),[j,g,P,b]);const k=async e=>{const a=P.find((a=>a._id===e));if(a){var t;const s=a.employeeClassData.map((e=>({name:e.label,value:e.payType}))).filter(((e,a,t)=>a===t.findIndex((a=>a.value===e.value)))),l=null===a||void 0===a||null===(t=a.employeeClassData)||void 0===t?void 0:t.find((e=>e.isDefaultPay));w((a=>({...a,instructor:a.instructor.map((a=>a.assistant===e?{...a,assistantPayOptions:s,assistantPay:l?l.payType:a.assistantPay}:a))})))}},S=(0,c.d4)((e=>{var a;return null===e||void 0===e||null===(a=e.loader)||void 0===a?void 0:a.isLoading})),_=e=>{let{name:a,value:t}=e;const s=(0,r.A)(a,t,D);w((e=>({...e,[a]:t,formErrors:s})))};(0,s.useEffect)((()=>{null!==D&&void 0!==D&&D.event&&(g((0,v.gw)(null===D||void 0===D?void 0:D.event)),w((e=>({...e,staff:null,payType:"",instructor:[{assistant:null,assistantPay:""}]}))))}),[null===D||void 0===D?void 0:D.event]);const{servicesEvents:B}=(0,c.d4)((e=>e.settings.schedule)),O=B&&(null===B||void 0===B||null===(a=B.EventService)||void 0===a?void 0:a.map((e=>{var a;return null===(a=e.eventLevel)||void 0===a?void 0:a._id}))),R=P.filter((e=>e.employeeClassData.some((e=>null===O||void 0===O?void 0:O.includes(e.isClassLevel))))).map((e=>({name:e.firstName,value:e._id})));(0,s.useEffect)((()=>(null!==D&&void 0!==D&&D.staff&&g((0,h.Zh)(null===D||void 0===D?void 0:D.staff)),()=>{g({type:m.g.CHANGE_EMPLOYEES_PAY_TYPE,payload:[]})})),[null===D||void 0===D?void 0:D.staff,g]),(0,s.useEffect)((()=>{if(A){var e;let a=null===A||void 0===A||null===(e=A.employeeClassData)||void 0===e?void 0:e.find((e=>e.isDefaultPay));w((e=>({...e,payType:a?a.payType:null})))}}),[A,P]);const I=async e=>{let{name:a,value:t,customIndex:s,fieldName:l}=e;const n={...D};let i=n[l][s];i[a]=t,"assistant"===a&&(n[l][s]=i,w((()=>({...n}))),await g((0,h.Zh)(t)));const o=(0,r.A)(a,t,i);if(i.formErrors=o,n[l][s]=i,w((()=>({...n}))),"assistant"===a){const e=t,a=P.find((a=>a._id===e));if(a){var d;const e=a.employeeClassData.map((e=>({name:e.label,value:e.payType}))).filter(((e,a,t)=>a===t.findIndex((a=>a.value===e.value)))),t=null===a||void 0===a||null===(d=a.employeeClassData)||void 0===d?void 0:d.find((e=>e.isDefaultPay));w((a=>({...a,instructor:a.instructor.map(((a,l)=>l===s?{...a,assistantPayOptions:e,assistantPay:t?t.payType:null}:a))})))}}},L=e=>{var a;const t=null===(a=D.instructor.filter(((a,t)=>t!==e)))||void 0===a?void 0:a.flatMap((e=>e.assistant)),s=[D.staff,...t];return R.filter((e=>!s.includes(e.value)))},M=(e,a)=>{w((t=>({...t,[a]:t[a].filter(((a,t)=>t!==e))})))};return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(i.A,{backText:"Classes",children:[(0,x.jsxs)(o.a,{children:[(0,x.jsx)(l.BR,{name:"event",label:"Class Name",options:N,onChange:_,data:D}),(0,x.jsx)(l.o4,{name:"isActive",data:D,onChange:_,extraClassName:"text-right"})]}),(0,x.jsxs)(o.Ay,{title:"When and Where",col:"12",children:[(0,x.jsxs)(o.a,{children:[(0,x.jsx)(l.BR,{name:"classMeet",label:"How often does class meet?",options:n.e6,onChange:_,data:D,col:"6"}),(0,x.jsx)(l.BR,{name:"classLocation",options:T,onChange:_,data:D,col:"6"}),(0,x.jsx)(l.wN,{name:"startDate",onChange:_,data:D}),(0,x.jsx)(l.wN,{name:"endDate",onChange:_,data:D,disabled:!(null!==D&&void 0!==D&&D.startDate)})]}),(0,x.jsx)(o.a,{extraClass:"justify-content-end",children:(0,x.jsx)(u.Ay,{label:"Add New Schedule",className:"mx-2 ",onClick:()=>{const e={days:[],startTime:"",timeFormat:""};w((a=>({...a,schedule:[...a.schedule,e]})))},loading:S})}),null===D||void 0===D||null===(t=D.schedule)||void 0===t?void 0:t.map(((e,a)=>(0,x.jsx)("div",{children:(0,x.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,x.jsx)(l.wN,{name:"startTime",customIndex:a,onChange:I,data:e,fieldName:"schedule",timeOnly:!0,placeholder:"Select Time",hourFormat:"12"}),(0,x.jsx)(l.Rx,{name:"days",customIndex:a,onChange:I,data:e,options:n.dl,fieldName:"schedule",col:4}),a>0&&(0,x.jsx)("i",{className:"pi pi-minus-circle mt-4",onClick:()=>M(a,"schedule")})]})},a)))]}),(0,x.jsxs)(o.Ay,{title:"Instructor",col:"12",children:[(0,x.jsxs)(o.a,{children:[(0,x.jsx)(l.BR,{name:"staff",options:R,onChange:_,data:D}),(0,x.jsx)(l.BR,{name:"payType",options:(()=>{var e,a;let t=null===A||void 0===A||null===(e=A.employeeClassData)||void 0===e?void 0:e.map((e=>({name:e.label,value:e.payType})));const s=new Set(null===t||void 0===t?void 0:t.map((e=>JSON.stringify(e))));return null===(a=Array.from(s))||void 0===a?void 0:a.map((e=>JSON.parse(e)))})(),onChange:_,data:D})]}),(0,x.jsx)(o.a,{extraClass:"justify-content-end",children:(0,x.jsx)(u.Ay,{label:"Add Assistant",className:"mx-2",onClick:()=>{const e={assistant:"",assistantPay:""};w((a=>({...a,instructor:[...a.instructor,e]})))},loading:S})}),null===D||void 0===D||null===(C=D.instructor)||void 0===C?void 0:C.map(((e,a)=>(0,x.jsx)("div",{children:(0,x.jsxs)(o.a,{extraClass:"align-items-center",children:[(0,x.jsx)(l.BR,{name:"assistant",customIndex:a,options:L(a),fieldName:"instructor",onChange:I,data:e}),(0,x.jsx)(l.BR,{name:"assistantPay",customIndex:a,options:e.assistantPayOptions,fieldName:"instructor",onChange:I,data:e}),a>0&&(0,x.jsx)("i",{className:"pi pi-minus-circle mt-4",onClick:()=>M(a,"instructor")})]})},a)))]}),(0,x.jsx)(o.Ay,{title:"Participants",col:"12",children:(0,x.jsxs)(o.a,{children:[(0,x.jsx)(l.Bt,{name:"totalCapacity",onChange:_,data:D}),(0,x.jsx)(l.Bt,{name:"waitlistPeople",label:"How many people can waitlist",onChange:_,data:D})]})}),(0,x.jsx)(o.Ay,{title:"Online Scheduling",col:"12",children:(0,x.jsxs)(o.a,{children:[(0,x.jsx)(l.ZD,{name:"clientSignupClass",label:"Allow clients to sign up for this class online",onChange:_,data:D,col:"12"}),(0,x.jsx)(l.Bt,{name:"onlineCapacity",label:"Online Capacity",onChange:_,data:D,col:"6"})]})}),(0,x.jsx)(o.Ay,{title:"Pricing",col:"12",children:(0,x.jsxs)(o.a,{children:[(0,x.jsx)(l.ZD,{name:"clientPaylater",label:"Allow clients to sign up now and pay later",onChange:_,data:D,col:"12"}),(0,x.jsx)(l.ZD,{name:"clientClassFree",label:"Clients can attend this class for free",onChange:_,data:D,col:"12"})]})}),(0,x.jsxs)(u.zp,{children:[(0,x.jsx)(u.Ay,{label:"Save",className:"mx-2",onClick:()=>{if((0,p.nV)(D,w)){let e=(0,p.Kk)(D.schedule);e.isValid||w((a=>({...a,schedule:e.data}))),e.isValid&&g(j?(0,y.fA)(j,D,E):(0,y.gR)(D,E))}},loading:S}),(0,x.jsx)(u.Ti,{label:"Cancel",onClick:()=>E.goBack()})]})]})})}}}]);
//# sourceMappingURL=895.87b8daea.chunk.js.map